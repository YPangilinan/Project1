<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travelogged.</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300&display=swap" rel="stylesheet">
    <link rel= "stylesheet" type = "text/css" href= "style.css">
  </head>
<body>
  <nav class="navbar navbar-light">
    <a class="navbar-brand text-light" href="#"> <img src="images/logo.png" height= "75px" alt=""> </a>
    <form class="form-inline my-2 my-lg-0">
        <input class="form-control mr-sm-2" type="search" placeholder="Explore" aria-label="Search">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit"><img src="https://img.icons8.com/ios-filled/64/000000/search.png"height = "25px"></button>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
  <span class="navbar-toggler-icon"></span>
   </button>
   
<div class="collapse navbar-collapse" id="navbarNavAltMarkup">
<div class="navbar-nav">
    <a class="nav-item nav-link" href="https://github.com/YPangilinan" target = "_blank">Yssabel's Github</a>
    <a class="nav-item nav-link" href="https://github.com/skang91" target = "_blank">Somin's Github</a>
    <a class="nav-item nav-link" href="https://ypangilinan.github.io/portfolio.html" target = "_blank">Yssabel's Portfolio</a>
    <a class="nav-item nav-link" href="https://skang91.github.io/Basic-Portfolio/" target = "_blank">Somin's Portfolio</a>
    
</div>
</div> 
</nav>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">MAIN MENU</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link" href="index.html"><img src="https://img.icons8.com/ios-glyphs/24/000000/paper-plane.png"/> Flights <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="events.html"><img src="https://img.icons8.com/ios-filled/50/000000/concert-day.png" height = "25px">Events to Attend</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="events.html"><img src="https://img.icons8.com/ios-glyphs/48/000000/map-marker.png"height = "25px">Map the City</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="list.html"><img src="https://img.icons8.com/wired/64/000000/theme-park.png" height = "25px">Notable Attractions</a>
          </li>
      </ul>
      </form>
    </div>
  </nav>
<div class="container">
   
        <div class="row">
          <div class="col-lg-4">
            <div class="card d-flex align-items-center p-2 mb-3">
              <form>
              <Label>City Name:</Label>
              <input id="city" type="text" title="cityName" placeholder="San Jose"></br>
                  <Label>Start Date:</Label>
              <input id="eventstart" type="date"><br>
              <Label>End Date:</Label>
              <input id="eventend" type="date"><br>
                  <button type="submit" class="btn btn-primary" id = "submit">Submit</button>
                </form>
          </div>
             <!----Code for weather widget----->  
             <a class="weatherwidget-io" href="https://forecast7.com/en/37d34n121d89/san-jose/?unit=us" data-label_1="SAN JOSE" data-label_2="WEATHER" data-font="Open Sans Condensed" >SAN JOSE WEATHER</a>
             <script>
             !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='https://weatherwidget.io/js/widget.min.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','weatherwidget-io-js');
             </script>
            <!--------end weather widget code----->
          </div>
        <div class="col-lg-8">
        <div class="card d-flex align-items-center p-2 mb-3" id= "eventCard">
        <table class="table mt-2">
            <thead>
              <tr>
                <th scope="col" id = "name"></th>
                <th scope="col">Event Name</th>
                <th scope="col">Event Date</th>
                <th scope="col">Venue</th>
                <th scope="col">Find More Info</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td></td>
              </tr>
            </tbody>
          </table>
    </div>
  </div>
</div>
<div class="row mt-3 mb-3">
  <div class="col-md-1">
     <img src = "https://a.travel-assets.com/flex/flexmanager/images/2019/06/27/TVLY_RTB_Homepage_NeverRoamAlone_img_40x40_20190626.png">
  </div>
    <div class="col-md-3">
      <b>You'll never have roam the world alone.</b>
      <br> Travelogged will provide you dependable service 24/7.
    </div>
    <div class="col-md-1">
      <img src = "https://a.travel-assets.com/flex/flexmanager/images/2019/06/27/TVLY_RTB_Homepage_WorldOfChoice_img_40x40_20190626.png">
    </div>
    <div class="col-md-3">
        <b>A world of options all in one place.</b>
      <br> <p>Travelogged provides over 2 API's for information about your next destination.</p>
      </div>
      <div class="col-md-1">
          <img src = "https://a.travel-assets.com/flex/flexmanager/images/2019/06/27/TVLY_RTB_Homepage_PriceMatchGuarantee_App_img_40x40_20190626.png">
      </div>
  <div class="col-md-3">
       <b> Peace of mind, wherever you may roam.</b>
       <br> Backed by Skyscanner, Ticketmaster & Google Maps (APIs). We guarantee to provide you the most up to date information the API can provide.</p>

  </div>
</div>
<footer>
  <div class="row">
      <div class="col-md-4">
          CREDITS: <br>
          <a href="https://icons8.com/icon/Iwq0eDJRjhnA/theme-park">Theme Park icon by Icons8</a>
            <a href="https://icons8.com/icon/59829/map-marker">Map Marker icon by Icons8</a><br>
            <a href="https://icons8.com/icon/CO3hv-ABAlp3/concert-day">Concert Day icon by Icons8</a>
            <a href="https://icons8.com/icon/59854/paper-plane">Paper Plane icon by Icons8</a><br>
          <a href="https://icons8.com/icon/7695/search">Search icon by Icons8</a><br>        
      </div>
      <div class="col-md-4">
          Made by Yssabel Pangilinan & Somin Kang <br>
          UCLA 2020
      </div>

  </div>
 
</footer>
    
 <script type = "text/javascript">

 //onclick for submit button
    $("#submit").on("click",function(){
        event.preventDefault();
        eventAjax();

    
    $("#city").val("");
   $("#eventstart").val("");
    $("#eventend").val("");
    });

//wrapper for ajax call    
function eventAjax(){
    //variables to put into queryURL
    var apiKey = "7elxdku9GGG5k8j0Xm8KWdANDgecHMV0";
    var startDate = $("#eventstart").val().trim() + "T12:23:00Z";
    var endDate = $("#eventend").val().trim() + "T12:23:00Z";
    var city = $("#city").val().trim();

    console.log(startDate);
    console.log(endDate);
    console.log(city);
    
    //initiate ajax call
    $.ajax({
     type:"GET",
     url:"https://app.ticketmaster.com/discovery/v2/events?apikey=" + apiKey + "&locale=en-US&startDateTime="+startDate + "&endDateTime="+ endDate + "&city=" + city,
     async:true,
    dataType: "json",
    success: function(json) {
              console.log(json);

   //adding city name to the table           
    $("#name").text("Events in " + city);          

    //iterate over event array for event name and date
    var event = (json._embedded.events);
      for (var i=0; i<event.length; i++){
            console.log(event[i].name);
            console.log(event[i].dates.start.localDate);
            var tBody = $("tbody");
            var tRow = $("<tr>");
            var eventName = $("<td>");
            var eventDate = $("<td>");
            eventDate.text(event[i].dates.start.localDate);
            eventName.text(event[i].name);

            //find more info
             var link = (event[i].url);
            console.log(link);
             var eventLink = $("<td>");
             eventLink.html("<a href=" + link + ">Ticket Info</a>");
            eventLink.addClass("link");

            //images column
            var images = (event[i].images);
            var eventImage = $("<img>");
            eventImage.attr("src", images[1].url);
            eventImage.css("width","200px");

            //venue column
            var venue = (event[i]._embedded.venues[0].name);
            console.log(venue);  
            var eventVenue = $("<td>");
            eventVenue.text(venue);
            tRow.append(eventImage,eventName,eventDate,eventVenue,eventLink);
            tBody.append(tRow);      
        }
           },
  error: function(xhr, status, err) {
           }
});

};
    </script>
  
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
</body>
</html>    